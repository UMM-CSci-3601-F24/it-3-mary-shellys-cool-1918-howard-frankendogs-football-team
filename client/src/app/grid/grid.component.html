<!-- Top Row -->
<div class="flex-row flex-wrap">
  <!-- Left Side: Control Dropdown Room Info -->
  <div class="column">
    <!-- Room Information -->
    <div>
      <mat-card>
        <h1 style="font-size: 2rem; margin: auto; margin-top: 2rem">{{this.gridPackage.name}}</h1>
        <p style="font-size: 1rem; margin: auto; margin-top: 1.2rem">Last Saved:</p>
        <p style="font-size: 1rem; margin: auto;">{{this.gridPackage.lastSaved | date:'short'}}</p>
        <div class="grid-buttons">
          <button (click)="copyGridLink()">Copy Grid Link</button>
          <button (click)="leaveGrid()">Leave Grid</button>
        </div>
      </mat-card>
    </div>
    <br />
    <!-- Control Instructions Drop down panel -->
    <div>
      <mat-card>
        <mat-card-header>
          <mat-card-title>Controls Key</mat-card-title>
        </mat-card-header>
        <mat-expansion-panel hideToggle>
          <mat-expansion-panel-header>
            <mat-panel-description>
              <mat-icon>tips_and_updates</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>
          <mat-card-content>
            <p>Typing/Letters types directly into the grid and move in the direction specified.</p>
            <p>Backspace alone deletes current cell value and moves opposite of direction specified.</p>
            <p>Ctrl + Backspace deletes current cell value without moving.</p>
            <p>Arrow keys alone navigate the array in the respective direction.</p>
            <p>Ctrl + Arrow keys bold the edge in the respective direction.</p>
            <p>Clicking on a cell will focus onto that cell.</p>
            <p>The left number input changes the number of cells in each row.</p>
            <p>The right number input changes the pixel size of each cell.</p>
          </mat-card-content>
        </mat-expansion-panel>
      </mat-card>
    </div>
  </div>
  <!-- Right Side: Control Inputs -->
  <div class="flex-row flex-wrap column">
    <mat-card>
      <mat-card-header>
        <mat-card-title>Controls</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="flex-row flex-wrap">
          <!-- height and width -->
          <div class="control-group">
            <p>Height</p>
            <input matInput [(ngModel)]="gridHeight" type="number" (input)="onSizeInput()"
              placeholder="{{ gridHeight }}" />
            <p>Width</p>
            <input matInput [(ngModel)]="gridWidth" type="number" (input)="onSizeInput()"
              placeholder="{{ gridWidth }}" />
          </div>
          <!-- Cell Size -->
          <div class="control-group">
            <p>Cell Size</p>
            <input matInput [(ngModel)]="cellSize" type="number" placeholder="{{ cellSize }}" />
          </div>
        </div>
        <!-- Highlight Colors -->
        <div class="control-group">
          <p>Highlight color:</p>
          <mat-radio-group aria-labelledby="example-radio-group-label" class="example-radio-group"
            [(ngModel)]="currentColor">
            @for (highlight of highlight; track highlight) {
            <mat-radio-button class="example-radio-button" [value]="highlight">{{ highlight }}</mat-radio-button>
            }
          </mat-radio-group>
        </div>
        <!-- Typing Direction -->
        <div class="control-group">
          <button mat-button (click)="cycleTypingDirection()">
            Cycle Typing Direction
          </button>
          <p>Current Typing Direction is {{ typeDirection }}</p>
        </div>
        <!-- Delete Direction Toggle -->
        <div class="control-group">
          <button mat-button (click)="deleteDirectionToggle()">
            Delete Direction
          </button>
          <p>Delete Direction Linked To Type Direction: {{ deleteDirectionBool }}</p>
        </div>
        @if (this.gridPackage.roomID !== null){
        <div class="control-group">
          <button class="save-button" data-test="saveGridButton" (click)="saveGrid()">
            Save Grid
          </button>
        </div>
        }
      </mat-card-content>
    </mat-card>
  </div>
</div>
<!-- Grid -->
<div class="flex-row">
  <div [ngStyle]="{
      height: gridHeight * cellSize + 'px',
      width: gridWidth * cellSize + 'px'
    }">
    <mat-grid-list cols="{{ gridWidth }}" gridHeight="1:1" gutterSize="0">
      @for (row of gridPackage.grid; track row; let rowIndex = $index) { @for
      (cell of row; track cell; let colIndex = $index) {
      <mat-grid-tile Rowspan="1" Colspan="1">
        <app-grid-cell tabindex="0" [gridCell]="gridPackage.grid[rowIndex][colIndex]"
          (keydown)="onKeydown($event, currentCol, currentRow)" (click)="onClick($event, colIndex, rowIndex)"
          [attr.row]="rowIndex" [attr.col]="colIndex" [row]="rowIndex" [col]="colIndex" [grid]="gridPackage.grid"
          [currentColor]="currentColor" [ngStyle]="{ height: cellSize + 'px', width: cellSize + 'px' }"
          (gridChange)="onGridChange()"></app-grid-cell>
      </mat-grid-tile>
      } }
    </mat-grid-list>
  </div>
</div>